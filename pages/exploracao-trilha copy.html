<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Debug Trilha</title>
    <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
    <script src="../js/cytoscape-sankofa.js"></script>
</head>
<body>
    <div id="mini-trilha-container" style="width: 100%; height: 400px; border: 1px solid #ccc;"></div>
    
    <script>
        // Função para extrair parâmetros da URL
        function getURLParams() {
            const urlParams = new URLSearchParams(window.location.search);
            console.log('=== PARÂMETROS DA URL ===', Array.from(urlParams.entries()));
            return {
                trilha: urlParams.get('trilha'),
                noClicado: urlParams.get('noClicado')
            };
        }

        // Processar parâmetros
        const params = getURLParams();
        
        console.log('=== PARÂMETROS RECEBIDOS ===');
        console.log('Trilha:', params.trilha);
        console.log('Nó clicado (raw):', params.noClicado);

        // Decodificar dados se existirem
        if (params.noClicado && params.trilha) {
            try {
                const trilha = params.trilha;
                const noClicado = JSON.parse(decodeURIComponent(params.noClicado));
                // Criar visualização usando a função reutilizável com base no grupo
                if (trilha) {
                    console.log('=== CRIANDO VISUALIZAÇÃO ===');
                    const cy = createCytoscape('mini-trilha-container', trilha);
                    console.log('Cytoscape criado com sucesso:', cy);
                    
                    // Destacar o nó clicado se disponível
                    if (noClicado && noClicado.id) {
                        cy.ready(() => {
                            const clickedNode = cy.getElementById(noClicado.id);
                            if (clickedNode.length > 0) {
                                clickedNode.addClass('highlighted');
                                console.log('Nó destacado:', noClicado.id);
                            }
                        });
                    }
                } else {
                    console.log('Grupo não especificado para criar visualização');
                }
                
            } catch (error) {
                console.error('Erro ao decodificar:', error);
            }
        } else {
            console.log('Nenhum dado recebido');
        }
    </script>
</body>
</html>
